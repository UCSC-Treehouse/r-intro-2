<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Data frames | Introduction to R, version 2</title>
  <meta name="description" content="2 Data frames | Introduction to R, version 2" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Data frames | Introduction to R, version 2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Data frames | Introduction to R, version 2" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="starting-out-in-r.html"/>
<link rel="next" href="plotting-with-ggplot2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html"><i class="fa fa-check"></i><b>1</b> Starting out in R</a><ul>
<li class="chapter" data-level="1.1" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#variables"><i class="fa fa-check"></i><b>1.1</b> Variables</a></li>
<li class="chapter" data-level="1.2" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#saving-code-in-an-r-script"><i class="fa fa-check"></i><b>1.2</b> Saving code in an R script</a></li>
<li class="chapter" data-level="1.3" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#vectors"><i class="fa fa-check"></i><b>1.3</b> Vectors</a></li>
<li class="chapter" data-level="1.4" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#types-of-vector"><i class="fa fa-check"></i><b>1.4</b> Types of vector</a></li>
<li class="chapter" data-level="1.5" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#indexing-vectors"><i class="fa fa-check"></i><b>1.5</b> Indexing vectors</a></li>
<li class="chapter" data-level="1.6" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#sequences"><i class="fa fa-check"></i><b>1.6</b> Sequences</a></li>
<li class="chapter" data-level="1.7" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#functions"><i class="fa fa-check"></i><b>1.7</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>2</b> Data frames</a><ul>
<li class="chapter" data-level="2.1" data-path="data-frames.html"><a href="data-frames.html#setting-up"><i class="fa fa-check"></i><b>2.1</b> Setting up</a></li>
<li class="chapter" data-level="2.2" data-path="data-frames.html"><a href="data-frames.html#loading-data"><i class="fa fa-check"></i><b>2.2</b> Loading data</a></li>
<li class="chapter" data-level="2.3" data-path="data-frames.html"><a href="data-frames.html#exploring"><i class="fa fa-check"></i><b>2.3</b> Exploring</a></li>
<li class="chapter" data-level="2.4" data-path="data-frames.html"><a href="data-frames.html#indexing-data-frames"><i class="fa fa-check"></i><b>2.4</b> Indexing data frames</a></li>
<li class="chapter" data-level="2.5" data-path="data-frames.html"><a href="data-frames.html#columns-are-vectors"><i class="fa fa-check"></i><b>2.5</b> Columns are vectors</a></li>
<li class="chapter" data-level="2.6" data-path="data-frames.html"><a href="data-frames.html#logical-indexing"><i class="fa fa-check"></i><b>2.6</b> Logical indexing</a></li>
<li class="chapter" data-level="2.7" data-path="data-frames.html"><a href="data-frames.html#factors"><i class="fa fa-check"></i><b>2.7</b> Factors</a></li>
<li class="chapter" data-level="2.8" data-path="data-frames.html"><a href="data-frames.html#sorting"><i class="fa fa-check"></i><b>2.8</b> Sorting</a></li>
<li class="chapter" data-level="2.9" data-path="data-frames.html"><a href="data-frames.html#joining-data-frames"><i class="fa fa-check"></i><b>2.9</b> Joining data frames</a></li>
<li class="chapter" data-level="2.10" data-path="data-frames.html"><a href="data-frames.html#further-reading"><i class="fa fa-check"></i><b>2.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>3</b> Plotting with ggplot2</a><ul>
<li class="chapter" data-level="3.1" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#elements-of-a-ggplot"><i class="fa fa-check"></i><b>3.1</b> Elements of a ggplot</a></li>
<li class="chapter" data-level="3.2" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#further-geoms"><i class="fa fa-check"></i><b>3.2</b> Further geoms</a></li>
<li class="chapter" data-level="3.3" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#highlighting-subsets"><i class="fa fa-check"></i><b>3.3</b> Highlighting subsets</a></li>
<li class="chapter" data-level="3.4" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#fine-tuning-a-plot"><i class="fa fa-check"></i><b>3.4</b> Fine-tuning a plot</a></li>
<li class="chapter" data-level="3.5" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#faceting"><i class="fa fa-check"></i><b>3.5</b> Faceting</a></li>
<li class="chapter" data-level="3.6" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#saving-ggplots"><i class="fa fa-check"></i><b>3.6</b> Saving ggplots</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing data</a><ul>
<li class="chapter" data-level="4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#summary-functions"><i class="fa fa-check"></i><b>4.1</b> Summary functions</a></li>
<li class="chapter" data-level="4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#missing-values"><i class="fa fa-check"></i><b>4.2</b> Missing values</a></li>
<li class="chapter" data-level="4.3" data-path="summarizing-data.html"><a href="summarizing-data.html#grouped-summaries"><i class="fa fa-check"></i><b>4.3</b> Grouped summaries</a></li>
<li class="chapter" data-level="4.4" data-path="summarizing-data.html"><a href="summarizing-data.html#t-test"><i class="fa fa-check"></i><b>4.4</b> t-test</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="thinking-in-r.html"><a href="thinking-in-r.html"><i class="fa fa-check"></i><b>5</b> Thinking in R</a><ul>
<li class="chapter" data-level="5.1" data-path="thinking-in-r.html"><a href="thinking-in-r.html#lists"><i class="fa fa-check"></i><b>5.1</b> Lists</a></li>
<li class="chapter" data-level="5.2" data-path="thinking-in-r.html"><a href="thinking-in-r.html#other-types-not-covered-here"><i class="fa fa-check"></i><b>5.2</b> Other types not covered here</a></li>
<li class="chapter" data-level="5.3" data-path="thinking-in-r.html"><a href="thinking-in-r.html#programming"><i class="fa fa-check"></i><b>5.3</b> Programming</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>6</b> Next steps</a><ul>
<li class="chapter" data-level="6.1" data-path="next-steps.html"><a href="next-steps.html#deepen-your-understanding"><i class="fa fa-check"></i><b>6.1</b> Deepen your understanding</a></li>
<li class="chapter" data-level="6.2" data-path="next-steps.html"><a href="next-steps.html#expand-your-vocabulary"><i class="fa fa-check"></i><b>6.2</b> Expand your vocabulary</a></li>
<li class="chapter" data-level="6.3" data-path="next-steps.html"><a href="next-steps.html#join-the-community"><i class="fa fa-check"></i><b>6.3</b> Join the community</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R, version 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-frames" class="section level1">
<h1><span class="header-section-number">2</span> Data frames</h1>
<p><em>Data frame</em> is R’s name for tabular data. We generally want each row in a data frame to represent a unit of observation, and each column to contain a different type of information about the units of observation. Tabular data in this form is called <a href="http://vita.had.co.nz/papers/tidy-data.html">“tidy data”</a>.</p>
<p>Today we will be using a collection of modern packages collectively known as the <a href="https://www.tidyverse.org/">Tidyverse</a>. R and its predecessor S have a history dating back to 1976. The Tidyverse fixes some dubious design decisions baked into “base R”, including having its own slightly improved form of data frame, which is called a <em>tibble</em>. Sticking to the Tidyverse where possible is generally safer, Tidyverse packages are more willing to generate errors rather than ignore problems.</p>
<div id="setting-up" class="section level2">
<h2><span class="header-section-number">2.1</span> Setting up</h2>
<p>Our first step is to download the files we need and to install the Tidyverse. This is the one step where we ask you to copy and paste some code:</p>
<p>If using RStudio Cloud, you might need to switch to R version 3.5.3 to successfully install Tidyverse. Use the drop-down in the top right corner of the page.</p>
<p>People also sometimes have problems installing all the packages in Tidyverse on Windows machines. If you run into problems you may have more success installing individual packages.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;dplyr&quot;</span>,<span class="st">&quot;readr&quot;</span>,<span class="st">&quot;tidyr&quot;</span>,<span class="st">&quot;ggplot2&quot;</span>))</a></code></pre></div>
<p>We need to load the <code>tidyverse</code> package in order to use it.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb63-2" data-line-number="2"></a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="co"># OR</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb63-5" data-line-number="5"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb63-6" data-line-number="6"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb63-7" data-line-number="7"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>The <code>tidyverse</code> package loads various other packages, setting up a modern R environment. In this section we will be using functions from the <code>dplyr</code>, <code>readr</code> and <code>tidyr</code> packages.</p>
<p>R is a language with mini-languages within it that solve specific problem domains. <code>dplyr</code> is such a mini-language, a set of “verbs” (functions) that work well together. <code>dplyr</code>, with the help of <code>tidyr</code> for some more complex operations, provides a way to perform most manipulations on a data frame that you might need.</p>
</div>
<div id="loading-data" class="section level2">
<h2><span class="header-section-number">2.2</span> Loading data</h2>
<p>We will use the <code>read_tsv</code> function from <code>readr</code> to load a data set. (See also <code>read.csv</code> in base R.) TSV stands for Tab Separated Values, and is a text format used to store tabular data. The first few lines of the file we are loading are shown below. Conventionally the first line contains column headings.</p>
<pre><code>th_sampleid    disease                             age_at_dx
TH03_0010_S01  acute leukemia of ambiguous lineage        11
TH03_0010_S02  acute leukemia of ambiguous lineage        11
THR33_1000_S01 medulloblastoma                             7
THR33_1001_S01 medulloblastoma                             5
THR33_1002_S01 medulloblastoma                             5
THR33_1003_S01 medulloblastoma                             3</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">sample_metadata &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;clinical_TumorCompendium_v10_PolyA_2019-07-25_clean.tsv&quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   sample = col_character(),
##   disease = col_character(),
##   age_at_dx = col_double(),
##   pedaya = col_character(),
##   gender = col_character()
## )</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="co"># downloaded from &quot;https://xena.treehouse.gi.ucsc.edu/download/clinical_TumorCompendium_v10_PolyA_2019-07-25.tsv&quot;</span></a></code></pre></div>
<p><code>read_tsv</code> has guessed the type of data each column holds:</p>
<ul>
<li><code>&lt;chr&gt;</code> - character strings</li>
<li><code>&lt;dbl&gt;</code> - numerical values. Technically these are “doubles”, which is a way of storing numbers with 15 digits precision.</li>
</ul>
<p>We will also encounter:</p>
<ul>
<li><code>&lt;lgl&gt;</code> - logical values, <code>TRUE</code> or <code>FALSE</code>.</li>
<li><code>&lt;int&gt;</code> - integers, a fancy name for whole numbers.</li>
<li><code>&lt;fct&gt;</code> - factors, categorical data. We will get to this shortly.</li>
</ul>
<p>You can also see this data frame referring to itself as “a tibble”. This is the Tidyverse’s improved form of data frame. Tibbles present themselves more conveniently than base R data frames. Base R data frames don’t show the type of each column, and output every row when you try to view them.</p>
<div id="tip-1" class="section level3 unnumbered tip">
<h3>Tip</h3>
<p>A data frame can also be created from vectors, with the <code>tibble</code> function. (See also <code>data.frame</code> in base R.) For example:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">foo=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="dt">bar=</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##     foo bar  
##   &lt;dbl&gt; &lt;chr&gt;
## 1    10 a    
## 2    20 b    
## 3    30 c</code></pre>
<p>The argument names become column names in the data frame.</p>
</div>
<div id="tip-2" class="section level3 unnumbered tip">
<h3>Tip</h3>
<p>The <em>path</em> to the file on our server is <code>&quot;download/clinical_TumorCompendium_v10_PolyA_2019-07-25.tsv&quot;</code>. This says, starting from your working directory, look in the directory <code>download</code> for the file <code>clinical_TumorCompendium_v10_PolyA_2019-07-25.tsv</code>. The steps in the path are separated by <code>/</code>. Your working directory is shown at the top of the console pane. The path needed might be different on your own computer, depending where you downloaded the file.</p>
<p>One way to work out the correct path is to find the file in the file browser pane, click on it and select “Import Dataset…”.</p>
<p><img src="figures/import.png" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
</div>
<div id="exploring" class="section level2">
<h2><span class="header-section-number">2.3</span> Exploring</h2>
<p>The <code>View</code> function gives us a spreadsheet-like view of the data frame.</p>
<pre><code>View(sample_metadata)</code></pre>
<p><code>print</code> with the <code>n</code> argument can be used to show more than the first 10 rows on the console.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">print</span>(sample_metadata, <span class="dt">n=</span><span class="dv">200</span>)</a></code></pre></div>
<p>We can extract details of the data frame with further functions:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="kw">nrow</span>(sample_metadata)</a></code></pre></div>
<pre><code>## [1] 11610</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw">ncol</span>(sample_metadata)</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">colnames</span>(sample_metadata)</a></code></pre></div>
<pre><code>## [1] &quot;sample&quot;    &quot;disease&quot;   &quot;age_at_dx&quot; &quot;pedaya&quot;    &quot;gender&quot;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">summary</span>(sample_metadata)</a></code></pre></div>
<pre><code>##     sample            disease            age_at_dx       pedaya         
##  Length:11610       Length:11610       Min.   : 0.0   Length:11610      
##  Class :character   Class :character   1st Qu.:39.0   Class :character  
##  Mode  :character   Mode  :character   Median :57.0   Mode  :character  
##                                        Mean   :50.7                     
##                                        3rd Qu.:68.0                     
##                                        Max.   :90.0                     
##     gender         
##  Length:11610      
##  Class :character  
##  Mode  :character  
##                    
##                    
## </code></pre>
</div>
<div id="indexing-data-frames" class="section level2">
<h2><span class="header-section-number">2.4</span> Indexing data frames</h2>
<p>Data frames can be subset using <code>[row,column]</code> syntax.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">sample_metadata[<span class="dv">4</span>,<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   disease        
##   &lt;chr&gt;          
## 1 medulloblastoma</code></pre>
<p>Note that while this is a single value, it is still wrapped in a data frame. (This is a behaviour specific to Tidyverse data frames.) More on this in a moment.</p>
<p>Columns can be given by name.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">sample_metadata[<span class="dv">4</span>,<span class="st">&quot;disease&quot;</span>]</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   disease        
##   &lt;chr&gt;          
## 1 medulloblastoma</code></pre>
<p>The column or row may be omitted, thereby retrieving the entire row or column.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">sample_metadata[<span class="dv">4</span>,]</a></code></pre></div>
<pre><code>## # A tibble: 1 x 5
##   sample         disease         age_at_dx pedaya              gender
##   &lt;chr&gt;          &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt; 
## 1 THR33_1001_S01 medulloblastoma         5 Yes, age &lt; 30 years male</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">sample_metadata[,<span class="st">&quot;disease&quot;</span>]</a></code></pre></div>
<pre><code>## # A tibble: 11,610 x 1
##    disease                            
##    &lt;chr&gt;                              
##  1 acute leukemia of ambiguous lineage
##  2 acute leukemia of ambiguous lineage
##  3 medulloblastoma                    
##  4 medulloblastoma                    
##  5 medulloblastoma                    
##  6 medulloblastoma                    
##  7 medulloblastoma                    
##  8 medulloblastoma                    
##  9 medulloblastoma                    
## 10 medulloblastoma                    
## # … with 11,600 more rows</code></pre>
<p>Multiple rows or columns may be retrieved using a vector.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">rows_wanted &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2">sample_metadata[rows_wanted,]</a></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   sample       disease                     age_at_dx pedaya          gender
##   &lt;chr&gt;        &lt;chr&gt;                           &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; 
## 1 TH03_0010_S… acute leukemia of ambiguou…        11 Yes, age &lt; 30 … female
## 2 THR33_1000_… medulloblastoma                     7 Yes, age &lt; 30 … female
## 3 THR33_1002_… medulloblastoma                     5 Yes, age &lt; 30 … female</code></pre>
<p>Vector indexing can also be written on a single line.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">sample_metadata[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>),]</a></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   sample       disease                     age_at_dx pedaya          gender
##   &lt;chr&gt;        &lt;chr&gt;                           &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; 
## 1 TH03_0010_S… acute leukemia of ambiguou…        11 Yes, age &lt; 30 … female
## 2 THR33_1000_… medulloblastoma                     7 Yes, age &lt; 30 … female
## 3 THR33_1002_… medulloblastoma                     5 Yes, age &lt; 30 … female</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">sample_metadata[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>,]</a></code></pre></div>
<pre><code>## # A tibble: 7 x 5
##   sample       disease                     age_at_dx pedaya          gender
##   &lt;chr&gt;        &lt;chr&gt;                           &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; 
## 1 TH03_0010_S… acute leukemia of ambiguou…        11 Yes, age &lt; 30 … female
## 2 TH03_0010_S… acute leukemia of ambiguou…        11 Yes, age &lt; 30 … female
## 3 THR33_1000_… medulloblastoma                     7 Yes, age &lt; 30 … female
## 4 THR33_1001_… medulloblastoma                     5 Yes, age &lt; 30 … male  
## 5 THR33_1002_… medulloblastoma                     5 Yes, age &lt; 30 … female
## 6 THR33_1003_… medulloblastoma                     3 Yes, age &lt; 30 … female
## 7 THR33_1004_… medulloblastoma                    26 Yes, age &lt; 30 … male</code></pre>
</div>
<div id="columns-are-vectors" class="section level2">
<h2><span class="header-section-number">2.5</span> Columns are vectors</h2>
<p>Ok, so how do we actually get data out of a data frame?</p>
<p>Under the hood, a data frame is a list of column vectors. We can use <code>$</code> to retrieve columns. Occasionally it is also useful to use <code>[[ ]]</code> to retrieve columns, for example if the column name we want is stored in a variable.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="kw">head</span>( sample_metadata<span class="op">$</span>disease )</a></code></pre></div>
<pre><code>## [1] &quot;acute leukemia of ambiguous lineage&quot;
## [2] &quot;acute leukemia of ambiguous lineage&quot;
## [3] &quot;medulloblastoma&quot;                    
## [4] &quot;medulloblastoma&quot;                    
## [5] &quot;medulloblastoma&quot;                    
## [6] &quot;medulloblastoma&quot;</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">head</span>( sample_metadata[[<span class="st">&quot;disease&quot;</span>]] )</a></code></pre></div>
<pre><code>## [1] &quot;acute leukemia of ambiguous lineage&quot;
## [2] &quot;acute leukemia of ambiguous lineage&quot;
## [3] &quot;medulloblastoma&quot;                    
## [4] &quot;medulloblastoma&quot;                    
## [5] &quot;medulloblastoma&quot;                    
## [6] &quot;medulloblastoma&quot;</code></pre>
<p>To get the “disease” value of the 4th row as above, but unwrapped, we can use:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">sample_metadata<span class="op">$</span>disease[<span class="dv">4</span>]</a></code></pre></div>
<pre><code>## [1] &quot;medulloblastoma&quot;</code></pre>
</div>
<div id="logical-indexing" class="section level2">
<h2><span class="header-section-number">2.6</span> Logical indexing</h2>
<p>A method of indexing that we haven’t discussed yet is logical indexing. Instead of specifying the row number or numbers that we want, we can give a logical vector which is <code>TRUE</code> for the rows we want and <code>FALSE</code> otherwise. This can also be used with vectors.</p>
<p>We will first do this in a slightly verbose way in order to understand it, then learn a more concise way to do this using the <code>dplyr</code> package.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">is_glioma &lt;-<span class="st"> </span>sample_metadata<span class="op">$</span>disease <span class="op">==</span><span class="st"> &quot;glioma&quot;</span></a>
<a class="sourceLine" id="cb100-2" data-line-number="2"></a>
<a class="sourceLine" id="cb100-3" data-line-number="3"><span class="kw">head</span>(is_glioma)</a></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">sum</span>(is_glioma)</a></code></pre></div>
<pre><code>## [1] 702</code></pre>
<p><code>sum</code> treats TRUE as 1 and FALSE as 0, so it tells us the number of TRUE elements in the vector.</p>
<p>We can use this logical vector to get the glioma samples from <code>sample_metadata</code>:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">sample_metadata[is_glioma,]</a></code></pre></div>
<pre><code>## # A tibble: 702 x 5
##    sample         disease age_at_dx pedaya              gender      
##    &lt;chr&gt;          &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;       
##  1 TH03_0117_S01  glioma       0.9  Yes, age &lt; 30 years not reported
##  2 TH06_1175_S01  glioma      17    Yes, age &lt; 30 years female      
##  3 TH38_1311_S02  glioma      13    Yes, age &lt; 30 years male        
##  4 TH38_1346_S02  glioma      11    Yes, age &lt; 30 years female      
##  5 TH34_1445_S02  glioma       7    Yes, age &lt; 30 years female      
##  6 THR24_1924_S01 glioma       5.33 Yes, age &lt; 30 years female      
##  7 THR24_1925_S01 glioma      15.0  Yes, age &lt; 30 years female      
##  8 THR24_1925_S02 glioma      15.0  Yes, age &lt; 30 years female      
##  9 THR24_1926_S01 glioma      13.1  Yes, age &lt; 30 years male        
## 10 THR24_1926_S02 glioma      13.1  Yes, age &lt; 30 years male        
## # … with 692 more rows</code></pre>
<p>Comparison operators available are:</p>
<ul>
<li><code>x == y</code> – “equal to”</li>
<li><code>x != y</code> – “not equal to”</li>
<li><code>x &lt; y</code> – “less than”</li>
<li><code>x &gt; y</code> – “greater than”</li>
<li><code>x &lt;= y</code> – “less than or equal to”</li>
<li><code>x &gt;= y</code> – “greater than or equal to”</li>
</ul>
<p>More complicated conditions can be constructed using logical operators:</p>
<ul>
<li><code>a &amp; b</code> – “and”, TRUE only if both <code>a</code> and <code>b</code> are TRUE.</li>
<li><code>a | b</code> – “or”, TRUE if either <code>a</code> or <code>b</code> or both are TRUE.</li>
<li><code>! a</code> – “not” , TRUE if <code>a</code> is FALSE, and FALSE if <code>a</code> is TRUE.</li>
</ul>
<p>The <code>age_at_dx</code> column of <code>sample_metadata</code> tells the age at which the person was diagnosed. We could see which gliomas occured in people over 65 with:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">senior_gliomas &lt;-<span class="st"> </span>is_glioma <span class="op">&amp;</span><span class="st"> </span>sample_metadata<span class="op">$</span>age_at_dx <span class="op">&gt;</span><span class="dv">65</span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2"></a>
<a class="sourceLine" id="cb106-3" data-line-number="3">sample_metadata[senior_gliomas,]</a></code></pre></div>
<pre><code>## # A tibble: 33 x 5
##    sample          disease age_at_dx pedaya gender
##    &lt;chr&gt;           &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; 
##  1 TCGA-CS-4941-01 glioma         67 No     male  
##  2 TCGA-DB-A64L-01 glioma         67 No     female
##  3 TCGA-DH-A669-01 glioma         70 No     male  
##  4 TCGA-DH-A669-02 glioma         70 No     male  
##  5 TCGA-DU-6393-01 glioma         66 No     male  
##  6 TCGA-DU-6400-01 glioma         66 No     female
##  7 TCGA-DU-7012-01 glioma         74 No     female
##  8 TCGA-DU-7292-01 glioma         69 No     male  
##  9 TCGA-DU-7306-01 glioma         67 No     male  
## 10 TCGA-DU-8167-01 glioma         69 No     female
## # … with 23 more rows</code></pre>
<p><code>senior_gliomas</code> seems like it should be kept within our <code>sample_metadata</code> data frame for future use. We can add it as a new column of the data frame with:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">sample_metadata<span class="op">$</span>senior_glioma &lt;-<span class="st"> </span>senior_gliomas</a>
<a class="sourceLine" id="cb108-2" data-line-number="2"></a>
<a class="sourceLine" id="cb108-3" data-line-number="3">sample_metadata</a></code></pre></div>
<pre><code>## # A tibble: 11,610 x 6
##    sample     disease            age_at_dx pedaya      gender senior_glioma
##    &lt;chr&gt;      &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;lgl&gt;        
##  1 TH03_0010… acute leukemia of…        11 Yes, age &lt;… female FALSE        
##  2 TH03_0010… acute leukemia of…        11 Yes, age &lt;… female FALSE        
##  3 THR33_100… medulloblastoma            7 Yes, age &lt;… female FALSE        
##  4 THR33_100… medulloblastoma            5 Yes, age &lt;… male   FALSE        
##  5 THR33_100… medulloblastoma            5 Yes, age &lt;… female FALSE        
##  6 THR33_100… medulloblastoma            3 Yes, age &lt;… female FALSE        
##  7 THR33_100… medulloblastoma           26 Yes, age &lt;… male   FALSE        
##  8 THR33_100… medulloblastoma           10 Yes, age &lt;… male   FALSE        
##  9 THR33_100… medulloblastoma            3 Yes, age &lt;… male   FALSE        
## 10 THR33_100… medulloblastoma           27 Yes, age &lt;… male   FALSE        
## # … with 11,600 more rows</code></pre>
<div id="challenge-logical-indexing" class="section level3 unnumbered challenge">
<h3>Challenge: logical indexing</h3>
<ol style="list-style-type: decimal">
<li><p>Which samples are gliomas from seniors (over 65)?</p></li>
<li><p>Which samples are in neither glioma nor from seniors?</p></li>
<li><p>How many samples are from seniors?</p></li>
</ol>
</div>
<div id="a-dplyr-shorthand" class="section level3">
<h3><span class="header-section-number">2.6.1</span> A <code>dplyr</code> shorthand</h3>
<p>The above method is a little laborious. We have to keep mentioning the name of the data frame, and there is a lot of punctuation to keep track of. <code>dplyr</code> provides a slightly magical function called <code>filter</code> which lets us write more concisely. For example:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="kw">filter</span>(sample_metadata, sample_metadata<span class="op">$</span>age_at_dx <span class="op">&gt;</span><span class="dv">65</span> <span class="op">&amp;</span><span class="st"> </span>disease <span class="op">==</span><span class="st"> &quot;glioma&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 33 x 6
##    sample          disease age_at_dx pedaya gender senior_glioma
##    &lt;chr&gt;           &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;lgl&gt;        
##  1 TCGA-CS-4941-01 glioma         67 No     male   TRUE         
##  2 TCGA-DB-A64L-01 glioma         67 No     female TRUE         
##  3 TCGA-DH-A669-01 glioma         70 No     male   TRUE         
##  4 TCGA-DH-A669-02 glioma         70 No     male   TRUE         
##  5 TCGA-DU-6393-01 glioma         66 No     male   TRUE         
##  6 TCGA-DU-6400-01 glioma         66 No     female TRUE         
##  7 TCGA-DU-7012-01 glioma         74 No     female TRUE         
##  8 TCGA-DU-7292-01 glioma         69 No     male   TRUE         
##  9 TCGA-DU-7306-01 glioma         67 No     male   TRUE         
## 10 TCGA-DU-8167-01 glioma         69 No     female TRUE         
## # … with 23 more rows</code></pre>
<p>In the second argument, we are able to refer to columns of the data frame as though they were variables. The code is beautiful, but also opaque. It’s important to understand that under the hood we are creating and combining logical vectors.</p>
</div>
</div>
<div id="factors" class="section level2">
<h2><span class="header-section-number">2.7</span> Factors</h2>
<p>The <code>count</code> function from <code>dplyr</code> can help us understand the contents of some of the columns in <code>sample_metadata</code>. <code>count</code> is also <em>magical</em>, we can refer to columns of the data frame directly in the arguments to <code>count</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">count</span>(sample_metadata, pedaya)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   pedaya                  n
##   &lt;chr&gt;               &lt;int&gt;
## 1 No                   9408
## 2 Unknown                 1
## 3 Yes, age &lt; 30 years  2201</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="kw">count</span>(sample_metadata, senior_glioma)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   senior_glioma     n
##   &lt;lgl&gt;         &lt;int&gt;
## 1 FALSE         11577
## 2 TRUE             33</code></pre>
<p>One annoyance here is that the different categories in <code>pedaya</code> aren’t in a sensible order. This comes up quite often, for example when sorting or plotting categorical data. R’s solution is a further type of vector called a <em>factor</em> (think a factor of an experimental design). A factor holds categorical data, and has an associated ordered set of <em>levels</em>. It is otherwise quite similar to a character vector.</p>
<p>Any sort of vector can be converted to a factor using the <code>factor</code> function. This function defaults to placing the levels in alphabetical order, but takes a <code>levels</code> argument that can override this.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1"><span class="kw">head</span>( <span class="kw">factor</span>(sample_metadata<span class="op">$</span>pedaya, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Yes, age &lt; 30 years&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Unknown&quot;</span>)) )</a></code></pre></div>
<pre><code>## [1] Yes, age &lt; 30 years Yes, age &lt; 30 years Yes, age &lt; 30 years
## [4] Yes, age &lt; 30 years Yes, age &lt; 30 years Yes, age &lt; 30 years
## Levels: Yes, age &lt; 30 years No Unknown</code></pre>
<p>We should modify the <code>pedaya</code> column of the <code>sample_metadata</code> table in order to use this:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">sample_metadata<span class="op">$</span>pedaya &lt;-<span class="st"> </span><span class="kw">factor</span>(sample_metadata<span class="op">$</span>pedaya,</a>
<a class="sourceLine" id="cb118-2" data-line-number="2">                                 <span class="kw">c</span>(<span class="st">&quot;Yes, age &lt; 30 years&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Unknown&quot;</span>))</a></code></pre></div>
<p><code>count</code> now produces the desired order of output:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1"><span class="kw">count</span>(sample_metadata, pedaya)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   pedaya                  n
##   &lt;fct&gt;               &lt;int&gt;
## 1 Yes, age &lt; 30 years  2201
## 2 No                   9408
## 3 Unknown                 1</code></pre>
<p>We can count two categorical columns at once.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="kw">count</span>(sample_metadata, pedaya, senior_glioma)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   pedaya              senior_glioma     n
##   &lt;fct&gt;               &lt;lgl&gt;         &lt;int&gt;
## 1 Yes, age &lt; 30 years FALSE          2201
## 2 No                  FALSE          9375
## 3 No                  TRUE             33
## 4 Unknown             FALSE             1</code></pre>
<div id="challenge-counting" class="section level3 unnumbered challenge">
<h3>Challenge: counting</h3>
<p>Investigate how many acute myeloid leukemia samples come from adult or pediatric individuals using <code>count</code></p>
</div>
</div>
<div id="sorting" class="section level2">
<h2><span class="header-section-number">2.8</span> Sorting</h2>
<p>Data frames can be sorted using the <code>arrange</code> function in <code>dplyr</code>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="kw">arrange</span>(sample_metadata, age_at_dx)</a></code></pre></div>
<pre><code>## # A tibble: 11,610 x 6
##    sample     disease            age_at_dx pedaya      gender senior_glioma
##    &lt;chr&gt;      &lt;chr&gt;                  &lt;dbl&gt; &lt;fct&gt;       &lt;chr&gt;  &lt;lgl&gt;        
##  1 THR08_016… acute lymphoblast…         0 Yes, age &lt;… unkno… FALSE        
##  2 THR08_016… acute lymphoblast…         0 Yes, age &lt;… unkno… FALSE        
##  3 TH06_0613… atypical teratoid…         0 Yes, age &lt;… male   FALSE        
##  4 TH06_0613… atypical teratoid…         0 Yes, age &lt;… male   FALSE        
##  5 TH06_0627… glioblastoma mult…         0 Yes, age &lt;… female FALSE        
##  6 THR29_074… rhabdomyosarcoma           0 Yes, age &lt;… female FALSE        
##  7 THR29_074… embryonal rhabdom…         0 Yes, age &lt;… male   FALSE        
##  8 THR29_075… alveolar rhabdomy…         0 Yes, age &lt;… male   FALSE        
##  9 THR29_075… alveolar rhabdomy…         0 Yes, age &lt;… male   FALSE        
## 10 THR29_078… embryonal rhabdom…         0 Yes, age &lt;… female FALSE        
## # … with 11,600 more rows</code></pre>
<p>Numeric columns are sorted in numeric order. Character columns will be sorted in alphabetical order. Factor columns are sorted in order of their levels. The <code>desc</code> helper function can be used to sort in descending order.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="kw">arrange</span>(sample_metadata, <span class="kw">desc</span>(disease))</a></code></pre></div>
<pre><code>## # A tibble: 11,610 x 6
##    sample          disease    age_at_dx pedaya         gender senior_glioma
##    &lt;chr&gt;           &lt;chr&gt;          &lt;dbl&gt; &lt;fct&gt;          &lt;chr&gt;  &lt;lgl&gt;        
##  1 TH03_0012_S01   wilms tum…     18    Yes, age &lt; 30… male   FALSE        
##  2 TH03_0012_S02   wilms tum…     18    Yes, age &lt; 30… male   FALSE        
##  3 TH03_0144_S01   wilms tum…      6    Yes, age &lt; 30… male   FALSE        
##  4 TH27_2189_S01   wilms tum…      5    Yes, age &lt; 30… female FALSE        
##  5 TH06_0632_S01   wilms tum…      4    Yes, age &lt; 30… female FALSE        
##  6 TARGET-50-CAAA… wilms tum…      6.15 Yes, age &lt; 30… female FALSE        
##  7 TARGET-50-CAAA… wilms tum…      4.68 Yes, age &lt; 30… female FALSE        
##  8 TARGET-50-CAAA… wilms tum…      1.1  Yes, age &lt; 30… female FALSE        
##  9 TARGET-50-CAAA… wilms tum…      4.38 Yes, age &lt; 30… female FALSE        
## 10 TARGET-50-CAAA… wilms tum…      7.53 Yes, age &lt; 30… female FALSE        
## # … with 11,600 more rows</code></pre>
</div>
<div id="joining-data-frames" class="section level2">
<h2><span class="header-section-number">2.9</span> Joining data frames</h2>
<p>Let’s move on to a larger data set. These are some gene expression values.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1">expression_values &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;expression_data_for_MAP2K1_HRAS_v9_.tsv&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb127-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(sample, expression, <span class="op">-</span>Gene)</a>
<a class="sourceLine" id="cb127-3" data-line-number="3">expression_values</a></code></pre></div>
<pre><code>## # A tibble: 22,908 x 3
##    Gene   sample         expression
##    &lt;chr&gt;  &lt;chr&gt;               &lt;dbl&gt;
##  1 HRAS   THR15_0330_S01       5.77
##  2 MAP2K1 THR15_0330_S01       4.53
##  3 HRAS   THR29_0776_S01       6.99
##  4 MAP2K1 THR29_0776_S01       4.51
##  5 HRAS   THR11_0247_S01       6.10
##  6 MAP2K1 THR11_0247_S01       5.75
##  7 HRAS   THR08_0162_S01       4.48
##  8 MAP2K1 THR08_0162_S01       6.42
##  9 HRAS   TH27_1241_S01        6.41
## 10 MAP2K1 TH27_1241_S01        5.39
## # … with 22,898 more rows</code></pre>
<div id="quiz" class="section level3 challenge unnumbered">
<h3>Quiz</h3>
<p>What is the unit of observation in this new data frame?</p>
</div>
<div id="section-1" class="section level3 unnumbered">
<h3></h3>
<p>It would be useful to have general information about samples from <code>sample_metadata</code> available as columns when we use this data frame. <code>expression_values</code> and <code>sample_metadata</code> share a column called <code>sample</code> which can be used to match rows from one to the other.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1">expression_by_disease &lt;-<span class="st"> </span><span class="kw">left_join</span>(expression_values, sample_metadata, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>))</a>
<a class="sourceLine" id="cb129-2" data-line-number="2">expression_by_disease</a></code></pre></div>
<pre><code>## # A tibble: 22,908 x 8
##    Gene   sample  expression disease  age_at_dx pedaya gender senior_glioma
##    &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;fct&gt;  &lt;chr&gt;  &lt;lgl&gt;        
##  1 HRAS   THR15_…       5.77 &lt;NA&gt;          NA   &lt;NA&gt;   &lt;NA&gt;   NA           
##  2 MAP2K1 THR15_…       4.53 &lt;NA&gt;          NA   &lt;NA&gt;   &lt;NA&gt;   NA           
##  3 HRAS   THR29_…       6.99 rhabdom…      20   Yes, … male   FALSE        
##  4 MAP2K1 THR29_…       4.51 rhabdom…      20   Yes, … male   FALSE        
##  5 HRAS   THR11_…       6.10 glioma        13   Yes, … male   FALSE        
##  6 MAP2K1 THR11_…       5.75 glioma        13   Yes, … male   FALSE        
##  7 HRAS   THR08_…       4.48 acute l…       0.6 Yes, … unkno… FALSE        
##  8 MAP2K1 THR08_…       6.42 acute l…       0.6 Yes, … unkno… FALSE        
##  9 HRAS   TH27_1…       6.41 &lt;NA&gt;          NA   &lt;NA&gt;   &lt;NA&gt;   NA           
## 10 MAP2K1 TH27_1…       5.39 &lt;NA&gt;          NA   &lt;NA&gt;   &lt;NA&gt;   NA           
## # … with 22,898 more rows</code></pre>
<p>The “left” in “left join” refers to how rows that can’t be paired up are handled. <code>left_join</code> keeps all rows from the first data frame but not the second. This is a good default when the intent is to attaching some extra information to a data frame. <code>inner_join</code> discard all rows that can’t be paired up. <code>full_join</code> keeps all rows from both data frames.</p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2><span class="header-section-number">2.10</span> Further reading</h2>
<p>We’ve covered the fundamentals of dplyr and data frames, but there is much more to learn. Notably, we haven’t covered the use of the pipe <code>%&gt;%</code> to chain <code>dplyr</code> verbs together. The <a href="http://r4ds.had.co.nz/">“R for Data Science” book</a> is an excellent source to learn more. The Monash Data Fluency <a href="https://monashdatafluency.github.io/r-progtidy/">“Programming and Tidy data analysis in R” course</a> also covers this.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="starting-out-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-with-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["r-intro-2.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
